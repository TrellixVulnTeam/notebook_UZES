
## 基础的服务端模型

    循环模型
        循环接收客户端请求， 处理请求。 同一时刻只能处理一个请求，
        处理完毕再处理下一个

        优点
            实现简单， 单进程程序占用资源少
        缺点
            无法同时处理多个客户端任务
        适用情况
            处理的任务可以短时间完成，不需要建立并发，更适合UDP使用

    并发模型
        能够同时处理多个客户端请求
            IO 并发
                IO多路复用
                优点
                    资源消耗少， IO处理速度快
                缺点
                    不能适用CPU密集型程序
                    不能长期阻塞


            多进程/多线程并发
                原理
                    为每个客户端创建单独的进程线程，执行请求
                优点
                    每个客户端可以长期占有服务器运行程序，能够使用多核资源，可以处理
                    IO或者CPU运算
                缺点
                    消耗资源高


## 多进程并发模型

    使用fork实现多进程并发
        1. 创建套接字, 绑定监听
        2. 等待接收客户端请求
        3. 创建新的进程处理客户端请求
        4. 原有进程继续等待新的客户端链接
        5. 如果客户端退出则关闭子进程

    # 在父进程中忽略子进程状态改变，子进程退出自动由系统处理
        signal(SIGCHLD, SIG_IGN)


## 多线程并发

    对比多进程并发
        * 消耗资源少,
        * 线程应该更注意共享资源的操作
        * 在Python中应该注意GIL问题,网络延迟较高,线程并发也是一种可行的办法

    实现步骤
        1. 创建套接字, 绑定监听
        2. 接受客户端请求, 创建新的线程
        3. 主线程继续接受其他客户端链接
        4. 分支线程启动对应的函数处理客户端请求
        5. 当客户端断开, 则分支线程结束

## tarceback

    import traceback
    功能
        更详细的打印异常信息
    traceback.print_exc()


## 协程基础

    定义
        纤程，微线程. 协程的本质是一个单线程程序，所有以协程不能使用计算机多核资源.
    作用
        能够高效的完成并发任务，占用较少的资源，因此协程的并发量较高
    原理
        通过记录应用层的上下文栈区，实现在运行中进行上下文跳转达到可以选择性的运行
        想要运行的部分，以此提高程序的运行效率．
    优点
        消耗资源少，无需切换开销
        无需同步互斥，IO 并发性好
    缺点
        无法利用计算机多核资源


    yield 协程实现的基本关键字

## 第三方库
    greenlet
        gr = greenlet.greenlet()  # 生成协程对象
        gr.switch()  # 选择要执行打协程事件

    gevent
        1. 将协程事件封装为函数
        2. 生成协程对象
            gevent.spawn(func, argv)
            功能
                生成协程对象
            参数
                func
                    协程函数
                argv
                    给协程函数传参
            返回值
                返回协程对象
        3.　回收协程
            gevent.joinall()
            功能：
                回收协程
            参数
                列表，将要回收的协程放入列表

        gevent.sleep(n)
        功能
            设置协程阻塞，让协程跳转
        参数
            n 阻塞时间

        from gevent import monkey
        monkey.patch_all()
            功能
                修改套接字的IO阻塞行为
                
            *必须在socket 导入之前使用

























